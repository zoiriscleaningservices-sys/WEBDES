<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrueWebX – Global Business Directory | Find Local Services Worldwide</title>
    <meta name="description" content="TrueWebX is a global business directory connecting customers with trusted local services and companies worldwide. Search for trusted businesses, view profiles, photos, and contact details. Free consultation available.">
    <meta name="keywords" content="business directory, local services, global business listings, find local companies, professional services, free consultation, business profiles">
    <meta name="robots" content="index, follow">

    <!-- Open Graph / Twitter -->
    <meta property="og:title" content="TrueWebX – Global Business Directory">
    <meta property="og:description" content="Discover and connect with local businesses worldwide on TrueWebX. Browse detailed profiles, photos, and contact trusted service providers.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://truewebx.site/">
    <meta property="og:image" content="https://truewebx.site/og-image.jpg">
    <meta name="twitter:card" content="summary_large_image">

    <link rel="canonical" href="https://truewebx.site/">

    <!-- Preconnect + Favicons (cleaned up duplicates) -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="dns-prefetch" href="https://vrpyomevjlsacourdmki.supabase.co">

    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/favicon/site.webmanifest">

    <!-- Font Awesome – optimized -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" as="style">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" media="print" onload="this.media='all';this.onload=null" crossorigin>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2" defer></script>

    <meta name="supabase-anon-key" content="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZycHlvbWV2amxzYWNvdXJkbWtpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYxNzA4ODUsImV4cCI6MjA4MTc0Njg4NX0.BsugjF75UO4TArkH5CeOIvJnMZAj8g6Ccf6hu1NsrUM">

    <style>
        :root { 
            --coral: #ff6b6b; 
            --turquoise: #0d9488; 
            --white: #ffffff;
            --light-glass: rgba(255,255,255,0.16);
            --card-glass: rgba(255,255,255,0.14);
            --shadow: 0 8px 32px rgba(0,0,0,0.25);
        }
        *,*::before,*::after{box-sizing:border-box}
        html,body{height:100%;width:100%;margin:0;padding:0;overscroll-behavior:none}
        body{
            font-family:system-ui,-apple-system,sans-serif;
            background:linear-gradient(135deg,var(--turquoise),var(--coral));
            background-attachment:fixed;
            color:var(--white);
            min-height:100vh;
            overflow-x:hidden;
            -webkit-font-smoothing:antialiased;
            -moz-osx-font-smoothing:grayscale;
        }
        .wrapper{
            width:100%;
            max-width:100vw;
            margin:0 auto;
            padding:0 16px;
            display:flex;
            flex-direction:column;
            min-height:100vh;
        }
        .header-wrapper{
            position:fixed;
            inset:0 0 auto 0;
            display:flex;
            justify-content:space-between;
            align-items:center;
            padding:16px 24px;
            z-index:1000;
            background:rgba(0,0,0,0.38);
            border-bottom:1px solid rgba(255,255,255,0.08);
            transition:background .25s ease;
            contain:style layout;
        }
        .header-wrapper.scrolled{background:rgba(0,0,0,0.58)}

        .logo{max-width:clamp(160px,35vw,280px);max-height:64px;height:auto}
        .logo img{width:100%;height:auto;max-height:64px;object-fit:contain;display:block}

        .login-btn{
            background:rgba(255,255,255,0.18);
            border:1px solid rgba(255,255,255,0.32);
            color:white;
            font-weight:600;
            padding:12px 24px;
            border-radius:50px;
            cursor:pointer;
            display:flex;
            align-items:center;
            gap:10px;
            font-size:1rem;
            transition:all .22s ease;
            text-decoration:none;
        }
        .login-btn:hover{background:rgba(255,255,255,0.32);transform:translateY(-2px)}

        .main-content{padding-top:110px;flex:1;display:flex;flex-direction:column;align-items:center}

        .hero{text-align:center;padding:50px 20px 30px;width:100%}
        .tagline{font-size:clamp(1.8rem,6vw,2.8rem);font-weight:700;margin-bottom:16px}
        .subtitle{font-size:clamp(1.1rem,4vw,1.5rem);opacity:.95;max-width:900px;margin:0 auto 40px;line-height:1.7}

        .search-container{width:100%;max-width:760px;margin:0 auto 30px;position:relative}
        .search-box{
            width:100%;
            padding:18px 70px 18px 28px;
            font-size:1.25rem;
            border-radius:50px;
            border:none;
            background:rgba(255,255,255,0.18);
            color:white;
            box-shadow:var(--shadow);
        }
        .search-box::placeholder{color:rgba(255,255,255,0.7)}
        .search-box:focus{outline:2px solid var(--coral);outline-offset:3px;box-shadow:0 0 0 5px rgba(255,107,107,.36)}
        .search-icon{position:absolute;right:24px;top:50%;transform:translateY(-50%);font-size:1.9rem;color:rgba(255,255,255,0.8);pointer-events:none}

        .promo-rotator{
            position:relative;
            width:100%;
            max-width:980px;
            height:clamp(400px,58vw,580px);
            margin:0 auto 40px;
            border-radius:28px;
            overflow:hidden;
            box-shadow:var(--shadow);
            background:var(--card-glass);
            border:1px solid rgba(255,255,255,.18);
            contain:content;
        }
        .promo-slide{
            position:absolute;
            inset:0;
            opacity:0;
            transition:opacity 1.1s ease-in-out;
            pointer-events:none;
            display:flex;
            align-items:center;
            justify-content:center;
            padding:20px;
        }
        .promo-slide.active{opacity:1;pointer-events:auto}

        /* ── remaining styles kept almost identical, just tightened transitions & removed heavy will-change ── */
        .glass{
            background:var(--light-glass);
            border-radius:32px;
            padding:40px 24px;
            margin:20px 0;
            border:1px solid rgba(255,255,255,.22);
            box-shadow:var(--shadow);
            width:100%;
            max-width:1400px;
            contain:content;
        }
        h2{font-size:clamp(2rem,6vw,3rem);margin-bottom:32px;text-align:center;font-weight:700}

        .services{
            display:grid;
            grid-template-columns:1fr;
            gap:32px;
            width:100%;
        }
        .card{
            background:var(--card-glass);
            border-radius:32px;
            overflow:hidden;
            box-shadow:var(--shadow);
            transition:transform .28s ease,opacity .4s ease;
            opacity:0;
            transform:translateY(16px);
            display:flex;
            flex-direction:column;
            width:100%;
            position:relative;
        }
        .card.loaded{opacity:1;transform:none}
        .card:hover{transform:translateY(-8px)}

        .profile-img-wrapper{
            width:100%;
            aspect-ratio:16/9;
            min-height:280px;
            overflow:hidden;
            background:rgba(0,0,0,.15);
            flex:0 0 auto;
        }
        .profile-img{
            width:100%;
            height:100%;
            object-fit:cover;
            object-position:top center;
            image-rendering:-webkit-optimize-contrast;
            transition:transform .4s ease;
        }
        .card:hover .profile-img{transform:scale(1.06)}

        .card-content{
            padding:28px;
            text-align:center;
            flex-grow:1;
            display:flex;
            flex-direction:column;
            justify-content:space-between;
        }
        .card h3{font-size:2rem;margin-bottom:10px;font-weight:700}
        .card .location{font-size:1.2rem;opacity:.9;margin-bottom:16px}
        .card .description-teaser{line-height:1.7;opacity:.95;margin-bottom:20px;flex-grow:1;overflow:hidden;display:-webkit-box;-webkit-line-clamp:4;-webkit-box-orient:vertical}

        .price{font-size:2rem !important;color:var(--coral) !important;font-weight:800;margin:20px 0}

        .view-btn{
            margin:24px auto 0;
            padding:16px 36px;
            background:var(--coral);
            color:white;
            border-radius:50px;
            text-decoration:none;
            font-weight:bold;
            font-size:1.2rem;
            transition:all .24s ease;
            display:inline-block;
        }
        .view-btn:hover{background:#ff8787;transform:translateY(-3px);box-shadow:0 6px 20px rgba(0,0,0,.3)}

        .load-more-btn{
            margin:40px auto 0;
            padding:14px 40px;
            background:rgba(255,255,255,.18);
            border:1px solid rgba(255,255,255,.35);
            border-radius:50px;
            color:white;
            font-size:1.1rem;
            cursor:pointer;
            transition:all .24s;
        }
        .load-more-btn:hover{background:rgba(255,255,255,.3)}

        .no-services{font-size:1.5rem;text-align:center;padding:80px 20px;opacity:.9}

        footer{text-align:center;padding:32px 20px;font-size:.95rem;opacity:.8;margin-top:auto;width:100%}

        @media (min-width:768px){.services{grid-template-columns:repeat(2,1fr)}}
        @media (min-width:1100px){.services{grid-template-columns:repeat(3,1fr);gap:40px}}
        @media (max-width:768px){.promo-rotator{margin:0 auto 32px}}

        /* Critical above-fold styles extracted */
        .hero,.search-container,.promo-rotator,.glass{margin-left:auto;margin-right:auto}
    </style>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9852676431523320" crossorigin="anonymous"></script>
</head>
<body>

<div class="wrapper">
    <header class="header-wrapper" id="header">
        <a href="/" class="logo" aria-label="TrueWebX Home">
            <img src="https://truewebx.site/favicon/TrueWebX.jpeg" alt="TrueWebX Logo" width="240" height="64" loading="eager" decoding="async" fetchpriority="high">
        </a>
        <a href="dashboard.html" class="login-btn" aria-label="Login or Sign Up">
            <i class="fas fa-user-circle" aria-hidden="true"></i> Login / Sign Up
        </a>
    </header>

    <main class="main-content">
        <section class="hero" aria-labelledby="hero-heading">
            <h2 id="hero-heading" class="tagline">Promote Your Business Worldwide</h2>
            <p class="subtitle">
                TrueWebX connects customers with trusted local professionals everywhere.<br>
                <strong>Free consultations • Verified services • Global reach</strong>
            </p>
        </section>

        <div class="search-container">
            <label for="searchInput" class="visually-hidden">Search businesses</label>
            <input type="text" id="searchInput" class="search-box" placeholder="Search services, businesses, or cities..." aria-label="Search businesses">
            <i class="fas fa-search search-icon" aria-hidden="true"></i>
        </div>

        <section class="promo-rotator" id="promoRotator" aria-label="Featured businesses"></section>

        <section class="glass" aria-labelledby="services-heading">
            <h2 id="services-heading">Available Services Worldwide</h2>
            <div class="services" id="list" role="list"></div>
            <button id="loadMoreBtn" class="load-more-btn" style="display:none;">Load More</button>
        </section>
    </main>

    <footer role="contentinfo">© 2026 TrueWebX – The global directory for professional services</footer>
</div>

<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","name":"TrueWebX","url":"https://truewebx.site/","potentialAction":{"@type":"SearchAction","target":"https://truewebx.site/?q={search_term_string}","query-input":"required name=search_term_string"}}
</script>

<script>
// ──────────────────────────────────────────────────────────────
// ULTRA-OPTIMIZED VERSION – max speed focus
// ──────────────────────────────────────────────────────────────

let ticking = false;
const header = document.getElementById('header');
function updateHeader(){
    header.classList.toggle('scrolled', scrollY > 50);
    ticking = false;
}
addEventListener('scroll', () => {
    if (!ticking) {
        requestAnimationFrame(updateHeader);
        ticking = true;
    }
}, {passive:true});

const supabaseUrl = 'https://vrpyomevjlsacourdmki.supabase.co';
const anonKey = document.querySelector('meta[name="supabase-anon-key"]')?.content?.trim();

if (!anonKey || anonKey.includes('YOUR_SUPABASE')) {
    document.getElementById('list').innerHTML = '<p class="no-services">Service temporarily unavailable.</p>';
} else {
    const supabase = supabase.createClient(supabaseUrl, anonKey);
    let allServices = [];
    let displayedCount = 0;
    const PAGE_SIZE = 9;
    const BASE_PATH = '/profile';

    const listEl = document.getElementById('list');
    const loadMoreBtn = document.getElementById('loadMoreBtn');

    async function loadInitialServices(){
        const { data, error } = await supabase
            .from('services')
            .select('*')
            .order('created_at', {ascending:false})
            .range(0, PAGE_SIZE-1);

        if (error) {
            listEl.innerHTML = '<p class="no-services">Error loading services.</p>';
            return;
        }

        allServices = data || [];
        displayedCount = allServices.length;
        renderServices(allServices);
        updateLoadMoreVisibility();
        checkPathAndRender();
        requestIdleCallback(startPromoRotator);
    }

    async function loadMoreServices(){
        const { data, error } = await supabase
            .from('services')
            .select('*')
            .order('created_at', {ascending:false})
            .range(displayedCount, displayedCount + PAGE_SIZE - 1);

        if (error || !data?.length) {
            loadMoreBtn.style.display = 'none';
            return;
        }

        allServices.push(...data);
        displayedCount += data.length;
        renderServices(allServices, true);
        updateLoadMoreVisibility();
    }

    function updateLoadMoreVisibility(){
        loadMoreBtn.style.display = (allServices.length >= PAGE_SIZE && displayedCount === allServices.length) ? 'block' : 'none';
    }

    function renderServices(services, append = false){
        const fragment = document.createDocumentFragment();
        const cards = services.map((s, i) => {
            const el = document.createElement('article');
            el.className = 'card';
            el.id = `service-${s.id}`;
            el.style.transitionDelay = `${Math.min(i*40,400)}ms`;
            el.innerHTML = `
                <button class="share-btn" aria-label="Copy profile link"><i class="fas fa-link"></i></button>
                <div class="profile-img-wrapper">
                    <img src="${s.profile || 'https://via.placeholder.com/800x600/0d9488/ffffff?text=Upload+Photo'}" 
                         alt="${s.name||'Business'}" class="profile-img" 
                         width="800" height="600" 
                         loading="${i<5?'eager':'lazy'}" 
                         decoding="async" 
                         fetchpriority="${i<3?'high':'low'}">
                </div>
                <div class="card-content">
                    <div>
                        <h3>${s.name||'Professional Service'}</h3>
                        <p class="location">${s.city||'Location not specified'}</p>
                        <p class="description-teaser">${s.description||'Professional service with free consultation'}</p>
                        ${s.photos?.length?`
                        <div class="photos">
                            ${s.photos.slice(0,3).map(p=>`<img src="${p}" alt="gallery" width="300" height="300" loading="lazy" decoding="async">`).join('')}
                            ${s.photos.length>3?`<div style="grid-column:1/-1;text-align:center;opacity:0.8">+${s.photos.length-3} more</div>`:''}
                        </div>`:''}
                        <p>Phone: <span class="private">${s.phone||'Contact for details'}</span></p>
                        <p>Email: <span class="private">${s.gmail||'Contact for details'}</span></p>
                        <p class="price"><strong>Free Consultation</strong></p>
                    </div>
                    <a href="${BASE_PATH}/${s.slug}" class="view-btn" data-slug="${s.slug}">View Full Profile →</a>
                </div>`;
            fragment.appendChild(el);
            return el;
        });

        if (append) {
            listEl.appendChild(fragment);
        } else {
            listEl.innerHTML = '';
            listEl.appendChild(fragment);
            if (!services.length) listEl.innerHTML = '<p class="no-services">No services published yet.</p>';
        }

        // lazy add loaded class
        const observer = new IntersectionObserver((entries, obs) => {
            entries.forEach(e => {
                if (e.isIntersecting) {
                    e.target.classList.add('loaded');
                    obs.unobserve(e.target);
                }
            });
        }, {rootMargin:'80px'});
        cards.forEach(c => observer.observe(c));

        // share buttons
        document.querySelectorAll('.share-btn').forEach(btn => {
            btn.onclick = e => {
                e.stopPropagation();
                const slug = btn.closest('.card').querySelector('[data-slug]').dataset.slug;
                const url = `${location.origin}${BASE_PATH}/${slug}`;
                navigator.clipboard.writeText(url).then(() => {
                    btn.innerHTML = '<i class="fas fa-check"></i>';
                    setTimeout(() => btn.innerHTML = '<i class="fas fa-link"></i>', 1800);
                }).catch(() => alert('Copy failed'));
            };
        });
    }

    // ── Fast infinite rotator ─────────────────────────────────────
    let currentPromoIndex = 0;
    let promoInterval;
    const PROMO_DURATION = 4800; // slightly faster

    function startPromoRotator(){
        const rotator = document.getElementById('promoRotator');
        const featured = allServices.filter(s => s.profile && !s.profile.includes('placeholder') && s.name?.trim());

        if (!featured.length) {
            rotator.innerHTML = '<p style="padding:80px 20px;text-align:center;opacity:0.85">No featured businesses yet</p>';
            return;
        }

        rotator.innerHTML = featured.map((s,i) => `
            <div class="promo-slide ${i===0?'active':''}" data-index="${i}">
                <article class="card">
                    <div class="profile-img-wrapper">
                        <img src="${s.profile}" alt="${s.name}" class="profile-img" loading="eager" decoding="async">
                    </div>
                    <div class="card-content">
                        <h3>${s.name}</h3>
                        <p class="location">${s.city||'Global'}</p>
                        <p class="description-teaser">${(s.description||'').slice(0,100)}${(s.description||'').length>100?'...':''}</p>
                        <p class="price"><strong>Free Consultation</strong></p>
                        <a href="${BASE_PATH}/${s.slug}" class="view-btn" data-slug="${s.slug}">View Profile →</a>
                    </div>
                </article>
            </div>
        `).join('');

        const slides = rotator.querySelectorAll('.promo-slide');

        function nextSlide(){
            slides[currentPromoIndex].classList.remove('active');
            currentPromoIndex = (currentPromoIndex + 1) % featured.length;
            slides[currentPromoIndex].classList.add('active');
        }

        promoInterval = setInterval(nextSlide, PROMO_DURATION);
    }

    // ── Single profile view ───────────────────────────────────────
    function showSingleProfile(slug){
        const service = allServices.find(s => s.slug === slug);
        if (!service) return renderServices(allServices);

        document.title = `${service.name} – #1 in ${service.city||'Your Area'} | TrueWebX`;

        // meta updates skipped for brevity & speed – keep if SEO critical

        const gallery = service.photos?.length ? `
            <div class="gallery-wrapper">
                <div class="gallery-slider" id="gallerySlider">
                    ${service.photos.map(p => `<img src="${p}" alt="gallery" loading="lazy" decoding="async" width="960" height="620">`).join('')}
                </div>
                <button class="gallery-arrow prev"><i class="fas fa-chevron-left"></i></button>
                <button class="gallery-arrow next"><i class="fas fa-chevron-right"></i></button>
            </div>` : '';

        document.querySelector('.glass').innerHTML = `
            <div class="profile-view-content">
                ${service.profile ? `<img src="${service.profile}" alt="${service.name}" loading="lazy" decoding="async" width="960" height="720">` : ''}
                <p style="font-size:1.5rem;line-height:1.9;max-width:860px;margin:40px auto;opacity:0.95;">
                    ${service.description || 'Professional, reliable service.'}
                </p>
                <div class="contact-box">
                    ${service.phone ? `<div class="contact-item"><i class="fas fa-phone"></i><a href="tel:${service.phone.replace(/[^0-9+]/g,'')}">${service.phone}</a></div>`:''}
                    ${service.gmail ? `<div class="contact-item"><i class="fas fa-envelope"></i><a href="mailto:${service.gmail}">Send Email</a></div>`:''}
                </div>
                <p style="font-size:2.8rem;color:var(--coral);font-weight:800;margin:60px 0;">Free Consultation Available</p>
                <h2 style="font-size:2.8rem;margin:70px 0 50px;">Gallery</h2>
                ${gallery}
                <a href="/" class="view-btn" style="padding:18px 50px;font-size:1.5rem;" onclick="history.replaceState({},'', '/'); renderServices(allServices); return false;">← Back</a>
            </div>`;

        // gallery slider logic (kept minimal)
        if (service.photos?.length > 1) {
            let i = 0;
            const slider = document.getElementById('gallerySlider');
            const move = () => slider.style.transform = `translateX(-${i*100}%)`;
            document.querySelector('.next').onclick = () => { i = (i+1)%service.photos.length; move(); };
            document.querySelector('.prev').onclick = () => { i = (i-1+service.photos.length)%service.photos.length; move(); };
        }

        history.replaceState({slug}, '', `${BASE_PATH}/${slug}`);
        scrollTo(0,0);
    }

    function checkPathAndRender(){
        const slug = location.pathname.startsWith(BASE_PATH + '/') ? location.pathname.slice(BASE_PATH.length + 1).replace(/\/$/,'') : null;
        if (slug) showSingleProfile(slug);
        else renderServices(allServices);
    }

    // search
    document.getElementById('searchInput').addEventListener('input', e => {
        const q = e.target.value.toLowerCase().trim();
        const filtered = q ? allServices.filter(s => 
            (s.name||'').toLowerCase().includes(q) || 
            (s.city||'').toLowerCase().includes(q) || 
            (s.description||'').toLowerCase().includes(q)
        ) : allServices;
        renderServices(filtered);
    }, {passive:true});

    addEventListener('popstate', checkPathAndRender);

    // ── start ─────────────────────────────────────────────────────
    addEventListener('DOMContentLoaded', () => {
        loadInitialServices();
        loadMoreBtn.onclick = loadMoreServices;
    });
}
</script>
</body>
</html>
